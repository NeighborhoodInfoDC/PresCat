1                                         The SAS System              23:28 Monday, April 27, 2015

NOTE: Copyright (c) 2002-2008 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.2 (TS2M3) 
      Licensed to THE URBAN INSTITUTE, Site 70097024.
NOTE: This session is executing on the X64_VSPRO  platform.



NOTE: SAS initialization used:
      real time           0.91 seconds
      cpu time            0.15 seconds
      

NOTE: AUTOEXEC processing beginning; file is D:\Users\ptatian\Documents\My SAS 
      Files\9.2\Autoexnt.sas.


NOTE: AUTOEXEC processing completed.

1          /**************************************************************************
2           Program:  Project_assisted_units.sas
3           Library:  PresCat
4           Project:  NeighborhoodInfo DC
5           Author:   P. Tatian
6           Created:  10/15/14
7           Version:  SAS 9.2
8           Environment:  Local Windows session (desktop)
9          
10          Description:  Summarize assisted units by project.
11          Program based on NLIHC\Prog\Assisted_units.sas, which was used for
12          the 2011 DC Housing Monitor analysis.
13         
14          Modifications:
15         **************************************************************************/
16         
17         %include "L:\SAS\Inc\StdLocal.sas";
NOTE: Libref _METADAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: L:\Libraries\Metadata\Data
60        +
61        +options ls=124 ps=48;    ** Landscape **;
62        +
63        +** Output title **;
64        +
65        +title "&_library/&_program:  NeighborhoodInfo DC";
66        +
67        +** Define General library for local session only **;
2 The SAS System                                                                                23:28 Monday, April 27, 2015

68        +
69        +%DCData_lib( General, env=windows, macdef=dcautos uiautos sasautos )
MPRINT(DCDATA_LIB):   options nomprint;
NOTE: Libref GENERA_L was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: D:\DCData\Libraries\General\Data
NOTE: Libref GENERA_R was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: L:\Libraries\General\Data
NOTE: Libref GENERAL was successfully assigned as follows: 
      Levels:           2
      Engine(1):        V9 
      Physical Name(1): D:\DCData\Libraries\General\Data
      Engine(2):        V9 
      Physical Name(2): L:\Libraries\General\Data

=====================================================================
Current FmtSearch Option value:

     WORK* LIBRARY* GENERAL

   *implicitly included by default.

=====================================================================
Status of current catalogs:

NOTE:    WORK.FORMATS DOES NOT EXIST
NOTE:    LIBRARY.FORMATS DOES NOT EXIST
NOTE:    GENERAL.FORMATS EXISTS
=====================================================================


=====================================================================
Current Sasautos Option value:

     GENERA_L DCAUTOS UIAUTOS SASAUTOS

=====================================================================


=====================================================================
Current Sasautos Option value:

     GENERA_L  GENERA_R DCAUTOS UIAUTOS SASAUTOS

=====================================================================
3 The SAS System                                                                                23:28 Monday, April 27, 2015


70        +
71        +%let _userid = %sysfunc( putc( %lowcase(&SYSUSERID), $longusr. ) );
NOTE: %INCLUDE (level 1) ending.
72         
73         ** Define libraries **;
74         %DCData_lib( PresCat, local=n )
MPRINT(DCDATA_LIB):   options nomprint;
NOTE: Libref PRESCA_R was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: L:\Libraries\PresCat\Data
NOTE: Libref PRESCAT was successfully assigned as follows: 
      Levels:           1
      Engine(1):        V9 
      Physical Name(1): L:\Libraries\PresCat\Data

=====================================================================
Current FmtSearch Option value:

     WORK* LIBRARY* GENERAL PRESCAT

   *implicitly included by default.

=====================================================================
Status of current catalogs:

NOTE:    WORK.FORMATS DOES NOT EXIST
NOTE:    LIBRARY.FORMATS DOES NOT EXIST
NOTE:    GENERAL.FORMATS EXISTS
NOTE:    PRESCAT.FORMATS EXISTS
=====================================================================


=====================================================================
Current Sasautos Option value:

     PRESCA_R GENERA_L GENERA_R DCAUTOS UIAUTOS SASAUTOS

=====================================================================

75         
76         %let MAXPROGS = 8;
77         %let PUBHSNG  = 1;
78         %let S8PROG   = 2;
79         %let LIHTC    = 3;
80         %let HOME     = 4;
4 The SAS System                                                                                23:28 Monday, April 27, 2015

81         %let CDBG     = 5;
82         %let HPTF     = 6;
83         %let TEBOND   = 7;
84         %let OTHER    = 8;
85         
86         proc format;
87           value ProgCat (notsorted)
88             1 = 'Public Housing only'
89             2 = 'Section 8 only'
90             9 = 'Section 8 and other subsidies'
91             3 = 'LIHTC only'
92             4 = 'HOME only'
93             5 = 'CDBG only'
94             6 = 'HPTF only'
95             /*7 = 'Other single subsidy'*/
96             8 = 'LIHTC and Tax Exempt Bond only'
97             7, 10 = 'All other combinations';
NOTE: Format PROGCAT has been output.
98           value ward
99             1 = 'Ward 1'
100            2 = 'Ward 2'
101            3 = 'Ward 3'
102            4 = 'Ward 4'
103            5 = 'Ward 5'
104            6 = 'Ward 6'
105            7 = 'Ward 7'
106            8 = 'Ward 8';
NOTE: Format WARD has been output.
107        
108        ** Combine project and subsidy data **;
109        

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

110        data Project_subsidy;
111        
112          merge
113            PresCat.Project
114              (drop=Cat_: Hud_Mgr_: Hud_Own_:)
115            PresCat.Subsidy
116              (keep=NLIHC_ID Portfolio Subsidy_Active Units_Assist POA_end
117               where=(Subsidy_Active));
118          by NLIHC_ID;
5 The SAS System                                                                                23:28 Monday, April 27, 2015

119        
120        run;

NOTE: There were 362 observations read from the data set PRESCAT.PROJECT.
NOTE: There were 675 observations read from the data set PRESCAT.SUBSIDY.
      WHERE Subsidy_Active;
NOTE: The data set WORK.PROJECT_SUBSIDY has 706 observations and 38 variables.
NOTE: Compressing data set WORK.PROJECT_SUBSIDY decreased size by 63.33 percent. 
      Compressed is 22 pages; un-compressed would require 60 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.01 seconds
      

121        
122        data Assisted_units;
123        
124          set Project_subsidy
125                (where=(portfolio~='Project Rental Assistance Contract (PRAC)'));
126          by NLIHC_ID;
127        
128          retain num_progs total_units min_asst_units max_asst_units asst_units1-asst_units&MAXPROGS
129                 poa_end_min poa_end_max;
130        
131          array a_aunits{&MAXPROGS} asst_units1-asst_units&MAXPROGS;
132        
133          if first.NLIHC_ID then do;
134        
135            total_units = .;
136            num_progs = 0;
137        
138            min_asst_units = .;
139            mid_asst_units = .;
140            max_asst_units = .;
141        
142            poa_end_min = .;
143            poa_end_max = .;
144        
145            do i = 1 to &MAXPROGS;
146              a_aunits{i} = 0;
147            end;
148        
149          end;
150        
151          num_progs + 1;
152        
6 The SAS System                                                                                23:28 Monday, April 27, 2015

153          total_units = max( total_units, Proj_Units_Tot, Units_Assist );
154        
155          select ( portfolio );
156            when ( 'PUBHSNG' ) a_aunits{&PUBHSNG} = Units_Assist;
157            when ( 'PB8' ) a_aunits{&S8PROG} = Units_Assist;
158            when ( "LIHTC" ) a_aunits{&LIHTC} = Units_Assist;
159            when ( "HOME" ) a_aunits{&HOME} = Units_Assist;
160            when ( 'CDBG' ) a_aunits{&CDBG} = Units_Assist;
161            when ( 'DC HPTF' ) a_aunits{&HPTF} = Units_Assist;
162            when ( 'TEBOND' ) a_aunits{&TEBOND} = Units_Assist;
163            otherwise a_aunits{&OTHER} = sum( Units_Assist, a_aunits{&OTHER} );
164          end;
165        
166          min_asst_units = max( Units_Assist, min_asst_units );
167        
168          poa_end_min = min( poa_end, poa_end_min );
169          poa_end_max = min( poa_end, poa_end_max );
170        
171          if last.NLIHC_ID then do;
172        
173            do i = 1 to &MAXPROGS;
174              a_aunits{i} = min( a_aunits{i}, total_units );
175            end;
176        
177            max_asst_units = min( sum( of asst_units1-asst_units&MAXPROGS ), total_units );
178        
179            mid_asst_units = min( round( mean( min_asst_units, max_asst_units ), 1 ), max_asst_units );
180        
181            if mid_asst_units ~= max_asst_units then err_asst_units = max_asst_units - mid_asst_units;
182        
183            ** Reporting categories **;
184        
185            if num_progs = 1 then do;
186        
187              if a_aunits{&PUBHSNG} > 0 then ProgCat = 1;
188              else if a_aunits{&S8PROG} > 0 then ProgCat = 2;
189              else if a_aunits{&LIHTC} > 0 then ProgCat = 3;
190              else if a_aunits{&HOME} > 0 then ProgCat = 4;
191              else if a_aunits{&CDBG} > 0 then ProgCat = 5;
192              else if a_aunits{&HPTF} > 0 then ProgCat = 6;
193              else if a_aunits{&TEBOND} > 0 or a_aunits{&OTHER} > 0 then ProgCat = 7;
194        
195            end;
196            else do;
197        
198              if num_progs = 2 and a_aunits{&LIHTC} > 0 and a_aunits{&TEBOND} > 0 then ProgCat = 8;
7 The SAS System                                                                                23:28 Monday, April 27, 2015

199              else if a_aunits{&S8PROG} > 0 then ProgCat = 9;
200              else ProgCat = 10;
201        
202            end;
203        
204            if min_asst_units > 0 then output;
205        
206          end;
207        
208          format poa_end_min poa_end_max mmddyy10.;
209        
210          drop i portfolio Subsidy_Active Units_Assist poa_end;
211        
212        run;

NOTE: Missing values were generated as a result of performing an operation on missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      8 at 153:17     52 at 166:20    262 at 168:17   262 at 169:17   2 at 174:21     
NOTE: There were 706 observations read from the data set WORK.PROJECT_SUBSIDY.
      WHERE 1 /* an obviously TRUE WHERE clause */ ;
NOTE: The data set WORK.ASSISTED_UNITS has 329 observations and 51 variables.
NOTE: Compressing data set WORK.ASSISTED_UNITS decreased size by 61.29 percent. 
      Compressed is 12 pages; un-compressed would require 31 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

213        
214        proc sort data=Assisted_units out=PresCat.Project_assisted_units;
215          by ProgCat NLIHC_ID;
216        
217        %File_info( data=PresCat.Project_assisted_units, printobs=0, freqvars=ProgCat Ward2012 Geo2010 )
MPRINT(FILE_INFO):   title2 "File = PresCat.Project_assisted_units";

NOTE: There were 329 observations read from the data set WORK.ASSISTED_UNITS.
NOTE: SAS sort was used.
NOTE: The data set PRESCAT.PROJECT_ASSISTED_UNITS has 329 observations and 51 variables.
NOTE: Compressing data set PRESCAT.PROJECT_ASSISTED_UNITS decreased size by 61.29 percent. 
      Compressed is 12 pages; un-compressed would require 31 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(FILE_INFO):   proc contents data=PresCat.Project_assisted_units;
8 The SAS System                                                                                23:28 Monday, April 27, 2015

MPRINT(FILE_INFO):   run;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      
NOTE: The PROCEDURE CONTENTS printed pages 1-3.

MPRINT(FILE_INFO):   options nolabel;
MPRINT(FILE_INFO):   proc means data=PresCat.Project_assisted_units n sum mean stddev min max;
MPRINT(FILE_INFO):   run;

NOTE: Multiple concurrent threads will be used to summarize data.
NOTE: There were 329 observations read from the data set PRESCAT.PROJECT_ASSISTED_UNITS.
NOTE: The PROCEDURE MEANS printed page 4.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(FILE_INFO):   options label;
MPRINT(FILE_INFO):   proc freq data=PresCat.Project_assisted_units;
MPRINT(FILE_INFO):   tables ProgCat Ward2012 Geo2010 / missing;
MPRINT(FILE_INFO):   run;

NOTE: There were 329 observations read from the data set PRESCAT.PROJECT_ASSISTED_UNITS.
NOTE: The PROCEDURE FREQ printed pages 5-8.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(FILE_INFO):   title2;
218        
219        proc print data=PresCat.Project_assisted_units n='Projects = ';
220          by ProgCat;
221          id NLIHC_ID;
222          var total_units min_asst_units mid_asst_units max_asst_units asst_units: poa_end_min poa_end_max;
223          sum total_units min_asst_units mid_asst_units max_asst_units asst_units: ;
224          format ProgCat ProgCat. total_units min_asst_units mid_asst_units max_asst_units asst_units: comma6.0
225                 poa_end_min poa_end_max mmddyy8.;
226        run;

NOTE: There were 329 observations read from the data set PRESCAT.PROJECT_ASSISTED_UNITS.
NOTE: The PROCEDURE PRINT printed pages 9-20.
NOTE: PROCEDURE PRINT used (Total process time):
9 The SAS System                                                                                23:28 Monday, April 27, 2015

      real time           0.00 seconds
      cpu time            0.00 seconds
      

227        
228        ods rtf file="&_dcdata_r_path\PresCat\Prog\Project_assisted_units.rtf" style=Styles.Rtf_arial_9pt;
NOTE: Writing RTF Body file: L:\Libraries\PresCat\Prog\Project_assisted_units.rtf
229        
230        options missing='0';
231        
232        proc tabulate data=PresCat.Project_assisted_units format=comma10. noseps missing;
233          where ProgCat ~= .;
234          class ProgCat / preloadfmt order=data;
235          class ward2012;
236          var mid_asst_units err_asst_units;
237          table
238            /** Rows **/
239            all='\b Total' ProgCat=' ',
240            /** Columns **/
241            n='Projects'
242            sum='Assisted Units' * ( mid_asst_units='Est.' err_asst_units='+/-' )
243            ;
244          table
245            /** Rows **/
246            all='\b Total' ProgCat=' ',
247            /** Columns **/
248            sum='Assisted Units by Ward' * ward2012=' ' * ( mid_asst_units='Est.' err_asst_units='+/-' )
249            ;
250          format ProgCat ProgCat.;
251        
252        run;

NOTE: Multiple concurrent threads will be used to summarize data.
NOTE: There were 329 observations read from the data set PRESCAT.PROJECT_ASSISTED_UNITS.
      WHERE ProgCat not = .;
NOTE: The PROCEDURE TABULATE printed pages 21-23.
NOTE: PROCEDURE TABULATE used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
      

253        
254        ods rtf close;
255        
256        run;

10 The SAS System                                                                               23:28 Monday, April 27, 2015

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           1.96 seconds
      cpu time            0.49 seconds
      
