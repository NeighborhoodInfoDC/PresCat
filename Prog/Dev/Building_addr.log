1                                       The SAS System           12:57 Sunday, October 13, 2013

NOTE: Copyright (c) 2002-2008 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.2 (TS2M3) 
      Licensed to THE URBAN INSTITUTE, Site 70097024.
NOTE: This session is executing on the X64_VSHOME  platform.



NOTE: SAS initialization used:
      real time           0.16 seconds
      cpu time            0.20 seconds
      

NOTE: AUTOEXEC processing beginning; file is C:\Users\Peter\Documents\My SAS 
      Files\9.2\Autoexnt.sas.


NOTE: AUTOEXEC processing completed.

1          /**************************************************************************
2           Program:  Building_addr.sas
3           Library:  PresCat
4           Project:  NeighborhoodInfo DC
5           Author:   P. Tatian
6           Created:  10/05/13
7           Version:  SAS 9.1
8           Environment:  Windows
9          
10          Description:  Compile data of building addresses, including
11          corrected addresses, for geocoding.
12         
13          NOTE: Need to put quotes (") around the SSL value for the 1st obs
14          in DC_Info_02_08_13_buildings.csv and around ZIP code in both input
15          files so that the vars will be char.
16         
17          Modifications:
18         **************************************************************************/
19         
20         /*%include "K:\Metro\PTatian\DCData\SAS\Inc\Stdhead.sas";*/
21         %include "C:\DCData\SAS\Inc\Stdhead.sas";
55        +
56        +options ls=124 ps=48;    ** Landscape **;
57        +
58        +** Output title **;
59        +
60        +title "&_library/&_program:  NeighborhoodInfo DC";
61        +
2 The SAS System                                                                              12:57 Sunday, October 13, 2013

62        +** Define General library for local session only **;
63        +
64        +%DCData_lib( General, env=windows, macdef=dcautos uiautos sasautos )
MPRINT(DCDATA_LIB):   options nomprint;
NOTE: The V6 engine on this host is limited to read-only access of SAS data files without index optimization.  V6 data 
      files cannot be created or updated and V6 catalogs cannot be read.
NOTE: Libref GENERAV6 was successfully assigned as follows: 
      Engine:        V6 
      Physical Name: C:\DCData\Libraries\General\Data
NOTE: Libref GENERAV8 was successfully assigned as follows: 
      Engine:        V8 
      Physical Name: C:\DCData\Libraries\General\Data
NOTE: Libref GENERAL was successfully assigned as follows: 
      Levels:           2
      Engine(1):        V8 
      Physical Name(1): C:\DCData\Libraries\General\Data
      Engine(2):        V6 
      Physical Name(2): C:\DCData\Libraries\General\Data

=====================================================================
Current FmtSearch Option value:

     WORK* LIBRARY* GENERAL

   *implicitly included by default.

=====================================================================
Status of current catalogs:

NOTE:    WORK.FORMATS DOES NOT EXIST
NOTE:    LIBRARY.FORMATS DOES NOT EXIST
NOTE:    GENERAL.FORMATS EXISTS
=====================================================================


=====================================================================
Current Sasautos Option value:

     GENERAL DCAUTOS UIAUTOS SASAUTOS

=====================================================================

65        +
66        +%let _userid = %sysfunc( putc( %lowcase(&SYSUSERID), $longusr. ) );
NOTE: %INCLUDE (level 1) ending.
67         
3 The SAS System                                                                              12:57 Sunday, October 13, 2013

68         ** Define libraries **;
69         %DCData_lib( PresCat )
MPRINT(DCDATA_LIB):   options nomprint;
NOTE: Libref PRESCAV6 was successfully assigned as follows: 
      Engine:        V6 
      Physical Name: C:\DCData\Libraries\PresCat\Data
NOTE: Libref PRESCAV8 was successfully assigned as follows: 
      Engine:        V8 
      Physical Name: C:\DCData\Libraries\PresCat\Data
NOTE: Libref PRESCAT was successfully assigned as follows: 
      Levels:           2
      Engine(1):        V8 
      Physical Name(1): C:\DCData\Libraries\PresCat\Data
      Engine(2):        V6 
      Physical Name(2): C:\DCData\Libraries\PresCat\Data

=====================================================================
Current FmtSearch Option value:

     WORK* LIBRARY* GENERAL PRESCAT

   *implicitly included by default.

=====================================================================
Status of current catalogs:

NOTE:    WORK.FORMATS DOES NOT EXIST
NOTE:    LIBRARY.FORMATS DOES NOT EXIST
NOTE:    GENERAL.FORMATS EXISTS
NOTE:    PRESCAT.FORMATS EXISTS
=====================================================================


=====================================================================
Current Sasautos Option value:

     PRESCAT GENERAL DCAUTOS UIAUTOS SASAUTOS

=====================================================================

70         
71         filename fimport "&_dcdata_path\PresCat\Raw\DC_Info_02_08_13_for_geocoding (address corrections).csv" lrecl=2000;
72         
73         proc import out=Addr_corr
74             datafile=fimport
75             dbms=csv replace;
4 The SAS System                                                                              12:57 Sunday, October 13, 2013

76           datarow=2;
77           guessingrows=500;
78           getnames=yes;
79         
80         run;

81          /**********************************************************************
82          *   PRODUCT:   SAS
83          *   VERSION:   9.2
84          *   CREATOR:   External File Interface
85          *   DATE:      13OCT13
86          *   DESC:      Generated SAS Datastep Code
87          *   TEMPLATE SOURCE:  (None Specified.)
88          ***********************************************************************/
89             data WORK.ADDR_CORR                               ;
90             %let _EFIERR_ = 0; /* set the ERROR detection macro variable */
91             infile FIMPORT delimiter = ',' MISSOVER DSD lrecl=32767 firstobs=2 ;
92                informat Proj_Name $227. ;
93                informat NLIHC_ID $8. ;
94                informat Proj_Addre $140. ;
95                informat Proj_Addre_corrected $48. ;
96                informat Proj_City $10. ;
97                informat Proj_ST $2. ;
98                informat Proj_Zip $7. ;
99                informat MAR_MATCHADDRESS $48. ;
100               informat MAR_XCOORD best32. ;
101               informat MAR_YCOORD best32. ;
102               informat MAR_LATITUDE best32. ;
103               informat MAR_LONGITUDE best32. ;
104               informat MAR_WARD $8. ;
105               informat MAR_CENSUS_TRACT best32. ;
106               informat MAR_ZIPCODE best32. ;
107               informat MARID best32. ;
108               informat MAR_ERROR $330. ;
109               informat MAR_SCORE best32. ;
110               informat MAR_SOURCEOPERATION $13. ;
111               informat MAR_IGNORE $1. ;
112               format Proj_Name $227. ;
113               format NLIHC_ID $8. ;
114               format Proj_Addre $140. ;
115               format Proj_Addre_corrected $48. ;
116               format Proj_City $10. ;
117               format Proj_ST $2. ;
118               format Proj_Zip $7. ;
119               format MAR_MATCHADDRESS $48. ;
120               format MAR_XCOORD best12. ;
5 The SAS System                                                                              12:57 Sunday, October 13, 2013

121               format MAR_YCOORD best12. ;
122               format MAR_LATITUDE best12. ;
123               format MAR_LONGITUDE best12. ;
124               format MAR_WARD $8. ;
125               format MAR_CENSUS_TRACT best12. ;
126               format MAR_ZIPCODE best12. ;
127               format MARID best12. ;
128               format MAR_ERROR $330. ;
129               format MAR_SCORE best12. ;
130               format MAR_SOURCEOPERATION $13. ;
131               format MAR_IGNORE $1. ;
132            input
133                        Proj_Name $
134                        NLIHC_ID $
135                        Proj_Addre $
136                        Proj_Addre_corrected $
137                        Proj_City $
138                        Proj_ST $
139                        Proj_Zip $
140                        MAR_MATCHADDRESS $
141                        MAR_XCOORD
142                        MAR_YCOORD
143                        MAR_LATITUDE
144                        MAR_LONGITUDE
145                        MAR_WARD $
146                        MAR_CENSUS_TRACT
147                        MAR_ZIPCODE
148                        MARID
149                        MAR_ERROR $
150                        MAR_SCORE
151                        MAR_SOURCEOPERATION $
152                        MAR_IGNORE $
153            ;
154            if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable */
155            run;

NOTE: The infile FIMPORT is:
      Filename=C:\DCData\Libraries\PresCat\Raw\DC_Info_02_08_13_for_geocoding (address corrections).csv,
      RECFM=V,LRECL=32767,File Size (bytes)=63411,
      Last Modified=13Oct2013:12:57:25,
      Create Time=07Oct2013:11:00:02

NOTE: 358 records were read from the infile FIMPORT.
      The minimum record length was 90.
      The maximum record length was 349.
NOTE: The data set WORK.ADDR_CORR has 358 observations and 20 variables.
6 The SAS System                                                                              12:57 Sunday, October 13, 2013

NOTE: Compressing data set WORK.ADDR_CORR decreased size by 72.73 percent. 
      Compressed is 6 pages; un-compressed would require 22 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

358 rows created in WORK.ADDR_CORR                            from FIMPORT.
  
  
  
NOTE: WORK.ADDR_CORR data set was successfully created.
NOTE: PROCEDURE IMPORT used (Total process time):
      real time           0.54 seconds
      cpu time            0.49 seconds
      

156        
157        filename fimport clear;
NOTE: Fileref FIMPORT has been deassigned.
158        
159        proc sort data=Addr_corr;
160          by NLIHC_ID Proj_Name;
161        run;

NOTE: There were 358 observations read from the data set WORK.ADDR_CORR.
NOTE: SAS sort was used.
NOTE: The data set WORK.ADDR_CORR has 358 observations and 20 variables.
NOTE: Compressing data set WORK.ADDR_CORR decreased size by 72.73 percent. 
      Compressed is 6 pages; un-compressed would require 22 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

162        
163        
164        filename fimport "&_dcdata_path\PresCat\Raw\DC_Info_02_08_13_buildings.csv" lrecl=2000;
165        
166        proc import out=Bldg_addr
167            datafile=fimport
168            dbms=csv replace;
169          datarow=2;
170          guessingrows=500;
171          getnames=yes;
172        
7 The SAS System                                                                              12:57 Sunday, October 13, 2013

173        run;

174         /**********************************************************************
175         *   PRODUCT:   SAS
176         *   VERSION:   9.2
177         *   CREATOR:   External File Interface
178         *   DATE:      13OCT13
179         *   DESC:      Generated SAS Datastep Code
180         *   TEMPLATE SOURCE:  (None Specified.)
181         ***********************************************************************/
182            data WORK.BLDG_ADDR                               ;
183            %let _EFIERR_ = 0; /* set the ERROR detection macro variable */
184            infile FIMPORT delimiter = ',' MISSOVER DSD lrecl=32767 firstobs=2 ;
185               informat Proj_Name $56. ;
186               informat NLIHC_ID $8. ;
187               informat Proj_Addre $139. ;
188               informat Bldg_Addre $44. ;
189               informat Bldg_SSL $11. ;
190               informat Bldg_City $10. ;
191               informat Bldg_ST $2. ;
192               informat Bldg_Zip $7. ;
193               format Proj_Name $56. ;
194               format NLIHC_ID $8. ;
195               format Proj_Addre $139. ;
196               format Bldg_Addre $44. ;
197               format Bldg_SSL $11. ;
198               format Bldg_City $10. ;
199               format Bldg_ST $2. ;
200               format Bldg_Zip $7. ;
201            input
202                        Proj_Name $
203                        NLIHC_ID $
204                        Proj_Addre $
205                        Bldg_Addre $
206                        Bldg_SSL $
207                        Bldg_City $
208                        Bldg_ST $
209                        Bldg_Zip $
210            ;
211            if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable */
212            run;

NOTE: The infile FIMPORT is:
      Filename=C:\DCData\Libraries\PresCat\Raw\DC_Info_02_08_13_buildings.csv,
      RECFM=V,LRECL=32767,File Size (bytes)=21727,
      Last Modified=13Oct2013:12:57:10,
8 The SAS System                                                                              12:57 Sunday, October 13, 2013

      Create Time=07Oct2013:10:59:52

NOTE: 189 records were read from the infile FIMPORT.
      The minimum record length was 78.
      The maximum record length was 190.
NOTE: The data set WORK.BLDG_ADDR has 189 observations and 8 variables.
NOTE: Compressing data set WORK.BLDG_ADDR decreased size by 20.00 percent. 
      Compressed is 4 pages; un-compressed would require 5 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

189 rows created in WORK.BLDG_ADDR                            from FIMPORT.
  
  
  
NOTE: WORK.BLDG_ADDR data set was successfully created.
NOTE: PROCEDURE IMPORT used (Total process time):
      real time           0.22 seconds
      cpu time            0.21 seconds
      

213        
214        filename fimport clear;
NOTE: Fileref FIMPORT has been deassigned.
215        
216        proc sort data=Bldg_addr;
217          by NLIHC_ID Proj_Name;
218        run;

NOTE: There were 189 observations read from the data set WORK.BLDG_ADDR.
NOTE: SAS sort was used.
NOTE: The data set WORK.BLDG_ADDR has 189 observations and 8 variables.
NOTE: Compressing data set WORK.BLDG_ADDR decreased size by 20.00 percent. 
      Compressed is 4 pages; un-compressed would require 5 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

219        
220        ** Merge data **;
221        
222        data Bldg_addr_corr;
223        
9 The SAS System                                                                              12:57 Sunday, October 13, 2013

224          merge
225            Addr_corr (drop=marid mar_: in=in1)
226            Bldg_addr (drop=Proj_Addre in=in2);
227          by NLIHC_ID Proj_Name;
228        
229          if not in1 then do;
230            %warn_put( msg="No entry in project list: " _n_= NLIHC_ID= Proj_Name= )
MPRINT(WARN_PUT):   put "WARN" "ING:" " " "No entry in project list: " _n_= NLIHC_ID= Proj_Name=;
231          end;
232        
233          if Proj_Addre_corrected = "{multiple}" and not in2 then do;
234            %warn_put( msg="No entry in building file for project with multiple addresses: " _n_= NLIHC_ID= Proj_Name= )
MPRINT(WARN_PUT):   put "WARN" "ING:" " " "No entry in building file for project with multiple addresses: " _n_= NLIHC_ID= 
Proj_Name=;
235          end;
236        
237          length Bldg_Addre_new $ 120;
238        
239          if Bldg_Addre = "" then do;
240            if Proj_Addre_corrected = "" then do;
241              Bldg_Addre_new = Proj_Addre;
242            end;
243            else do;
244              Bldg_Addre_new = Proj_Addre_corrected;
245            end;
246            Bldg_City = Proj_City;
247            Bldg_ST = Proj_ST;
248            Bldg_Zip = Proj_Zip;
249          end;
250          else do;
251            Bldg_Addre_new = Bldg_Addre;
252          end;
253        
254          format _all_ ;
255          informat _all_ ;
256        
257        run;

NOTE: There were 358 observations read from the data set WORK.ADDR_CORR.
NOTE: There were 189 observations read from the data set WORK.BLDG_ADDR.
NOTE: The data set WORK.BLDG_ADDR_CORR has 525 observations and 13 variables.
NOTE: Compressing data set WORK.BLDG_ADDR_CORR decreased size by 72.73 percent. 
      Compressed is 6 pages; un-compressed would require 22 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
10 The SAS System                                                                             12:57 Sunday, October 13, 2013

      

258        
259        %File_info( data=Bldg_addr_corr, printobs=30, stats= )
MPRINT(FILE_INFO):   title2 "File = Bldg_addr_corr";
MPRINT(FILE_INFO):   proc contents data=Bldg_addr_corr;
MPRINT(FILE_INFO):   run;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.02 seconds
      cpu time            0.03 seconds
      
NOTE: The PROCEDURE CONTENTS printed page 1.

MPRINT(FILE_INFO):   proc print data=Bldg_addr_corr (obs=30);
MPRINT(FILE_INFO):   title3 "Printing first 30 obs.";
MPRINT(FILE_INFO):   run;

NOTE: There were 30 observations read from the data set WORK.BLDG_ADDR_CORR.
NOTE: The PROCEDURE PRINT printed pages 2-3.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(FILE_INFO):   title3;
MPRINT(FILE_INFO):   title2;
260        
261        data Bldg_addr_corr_export;
262        
263          set Bldg_addr_corr;
264        
265          keep NLIHC_ID Proj_Name Bldg_SSL Bldg_City Bldg_ST Bldg_Zip Bldg_Addre_new;
266        
267        run;

NOTE: There were 525 observations read from the data set WORK.BLDG_ADDR_CORR.
NOTE: The data set WORK.BLDG_ADDR_CORR_EXPORT has 525 observations and 7 variables.
NOTE: Compressing data set WORK.BLDG_ADDR_CORR_EXPORT decreased size by 61.54 percent. 
      Compressed is 5 pages; un-compressed would require 13 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

268        
11 The SAS System                                                                             12:57 Sunday, October 13, 2013

269        %fdate( fmt=yymmddd10. )
MPRINT(FDATE):   data _null_;
MPRINT(FDATE):   call symput("fdate",left(put("13OCT2013"d,yymmddd10.)));
MPRINT(FDATE):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

270        
271        filename fexport "&_dcdata_path\PresCat\Raw\DC_Info_02_08_13_buildings_for_geocoding (&fdate).csv" lrecl=2000;
272        
273        proc export data=Bldg_addr_corr_export
274            outfile=fexport
275            dbms=csv replace;
276        
277        run;

278         /**********************************************************************
279         *   PRODUCT:   SAS
280         *   VERSION:   9.2
281         *   CREATOR:   External File Interface
282         *   DATE:      13OCT13
283         *   DESC:      Generated SAS Datastep Code
284         *   TEMPLATE SOURCE:  (None Specified.)
285         ***********************************************************************/
286            data _null_;
287            %let _EFIERR_ = 0; /* set the ERROR detection macro variable */
288            %let _EFIREC_ = 0;     /* clear export record count macro variable */
289            file FEXPORT delimiter=',' DSD DROPOVER lrecl=32767;
290            if _n_ = 1 then        /* write column names or labels */
291             do;
292               put
293                  "Proj_Name"
294               ','
295                  "NLIHC_ID"
296               ','
297                  "Bldg_SSL"
298               ','
299                  "Bldg_City"
300               ','
301                  "Bldg_ST"
302               ','
303                  "Bldg_Zip"
304               ','
12 The SAS System                                                                             12:57 Sunday, October 13, 2013

305                  "Bldg_Addre_new"
306               ;
307             end;
308           set  BLDG_ADDR_CORR_EXPORT   end=EFIEOD;
309               format Proj_Name $227. ;
310               format NLIHC_ID $8. ;
311               format Bldg_SSL $11. ;
312               format Bldg_City $10. ;
313               format Bldg_ST $2. ;
314               format Bldg_Zip $7. ;
315               format Bldg_Addre_new $120. ;
316             do;
317               EFIOUT + 1;
318               put Proj_Name $ @;
319               put NLIHC_ID $ @;
320               put Bldg_SSL $ @;
321               put Bldg_City $ @;
322               put Bldg_ST $ @;
323               put Bldg_Zip $ @;
324               put Bldg_Addre_new $ ;
325               ;
326             end;
327            if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable */
328            if EFIEOD then call symputx('_EFIREC_',EFIOUT);
329            run;

NOTE: The file FEXPORT is:
      Filename=C:\DCData\Libraries\PresCat\Raw\DC_Info_02_08_13_buildings_for_geocoding (2013-10-13).csv,
      RECFM=V,LRECL=32767,File Size (bytes)=0,
      Last Modified=13Oct2013:12:57:30,
      Create Time=13Oct2013:12:52:26

NOTE: 526 records were written to the file FEXPORT.
      The minimum record length was 50.
      The maximum record length was 123.
NOTE: There were 525 observations read from the data set WORK.BLDG_ADDR_CORR_EXPORT.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

525 records created in FEXPORT from BLDG_ADDR_CORR_EXPORT.
  
  
NOTE: "FEXPORT" file was successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
13 The SAS System                                                                             12:57 Sunday, October 13, 2013

      real time           0.05 seconds
      cpu time            0.06 seconds
      

330        
331        filename fexport clear;
NOTE: Fileref FEXPORT has been deassigned.
332        
333        

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           1.14 seconds
      cpu time            1.12 seconds
      
