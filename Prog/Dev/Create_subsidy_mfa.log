1                                         The SAS System             18:10 Monday, August 31, 2015

NOTE: Copyright (c) 2002-2008 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.2 (TS2M3) 
      Licensed to THE URBAN INSTITUTE, Site 70097024.
NOTE: This session is executing on the X64_VSPRO  platform.



NOTE: SAS initialization used:
      real time           0.84 seconds
      cpu time            0.18 seconds
      

NOTE: AUTOEXEC processing beginning; file is D:\Users\ptatian\Documents\My SAS 
      Files\9.2\Autoexnt.sas.


NOTE: AUTOEXEC processing completed.

1          /**************************************************************************
2           Program:  Create_subsidy_mfa.sas
3           Library:  PresCat
4           Project:  NeighborhoodInfo DC
5           Author:   P. Tatian
6           Created:  07/25/13
7           Version:  SAS 9.1
8           Environment:  Local Windows session (desktop)
9          
10          Description:  Create initial Subsidy data set.
11         
12          Modifications:
13           09/27/14 PAT Updated for SAS1.
14           10/16/14 PAT Added subsidy correction for NL000046.
15           10/19/14 PAT Updated DC_info and Sec8MF files.
16                        Removed subsidy correction for NL000046.
17                        Added updates to ID_MFA, MFA_START, MFA_END, MFA_ASSUNITS.
18           12/24/14 PAT Changed Subsidy_Info_Source_ID to property_id/contract_number.
19                        Mark projects with tracs_status='T' or missing from MFA
20                        update as inactive.
21           12/31/14 PAT Revised Program variable to use new codes.
22           01/08/15 PAT Changed Update_date to Update_dtm (datetime).
23           01/18/15 PAT Added Compl_end.
24           01/29/15 PAT Added property_id for Sayles Place/NL000262.
25           08/31/15 PAT Replace PresCat.DC_Info_10_19_14 with PresCat.DC_Info_07_08_15.
26                        Do not replace MFA_END dates if not missing.
27         **************************************************************************/
28         
29         %include "L:\SAS\Inc\StdLocal.sas";
NOTE: Libref _METADAT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: L:\Libraries\Metadata\Data
2 The SAS System                                                     18:10 Monday, August 31, 2015

75        +
76        +options ls=124 ps=48;    ** Landscape **;
77        +
78        +** Output title **;
79        +
80        +title "&_library/&_program:  NeighborhoodInfo DC";
81        +
82        +** Define General library for local session only **;
83        +
84        +%DCData_lib( General, env=windows, macdef=dcautos uiautos sasautos )
MPRINT(DCDATA_LIB):   options nomprint;
NOTE: Libref GENERA_L was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: D:\DCData\Libraries\General\Data
NOTE: Libref GENERA_R was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: L:\Libraries\General\Data
NOTE: Libref GENERAL was successfully assigned as follows: 
      Levels:           2
      Engine(1):        V9 
      Physical Name(1): D:\DCData\Libraries\General\Data
      Engine(2):        V9 
      Physical Name(2): L:\Libraries\General\Data

=====================================================================
Current FmtSearch Option value:

     WORK* LIBRARY* GENERAL

   *implicitly included by default.

=====================================================================
Status of current catalogs:

NOTE:    WORK.FORMATS DOES NOT EXIST
NOTE:    LIBRARY.FORMATS DOES NOT EXIST
NOTE:    GENERAL.FORMATS EXISTS
=====================================================================


=====================================================================
Current Sasautos Option value:

     TTAUTOS  GENERA_L DCAUTOS UIAUTOS SASAUTOS

=====================================================================
3 The SAS System                                                                               18:10 Monday, August 31, 2015



=====================================================================
Current Sasautos Option value:

     TTAUTOS GENERA_L  GENERA_R DCAUTOS UIAUTOS SASAUTOS

=====================================================================

85        +
86        +%let _userid = %sysfunc( putc( %lowcase(&SYSUSERID), $longusr. ) );
NOTE: %INCLUDE (level 1) ending.
87         
88         ** Define libraries **;
89         %DCData_lib( PresCat, local=n )
MPRINT(DCDATA_LIB):   options nomprint;
NOTE: Libref PRESCA_R was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: L:\Libraries\PresCat\Data
NOTE: Libref PRESCAT was successfully assigned as follows: 
      Levels:           1
      Engine(1):        V9 
      Physical Name(1): L:\Libraries\PresCat\Data

=====================================================================
Current FmtSearch Option value:

     WORK* LIBRARY* GENERAL PRESCAT

   *implicitly included by default.

=====================================================================
Status of current catalogs:

NOTE:    WORK.FORMATS DOES NOT EXIST
NOTE:    LIBRARY.FORMATS DOES NOT EXIST
NOTE:    GENERAL.FORMATS EXISTS
NOTE:    PRESCAT.FORMATS EXISTS
=====================================================================


=====================================================================
Current Sasautos Option value:

     TTAUTOS  PRESCA_R GENERA_L GENERA_R DCAUTOS UIAUTOS SASAUTOS

4 The SAS System                                                                               18:10 Monday, August 31, 2015

=====================================================================

90         %DCData_lib( HUD, local=n )
MPRINT(DCDATA_LIB):   options nomprint;
NOTE: Libref HUD_R was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: L:\Libraries\HUD\Data
NOTE: Libref HUD was successfully assigned as follows: 
      Levels:           1
      Engine(1):        V9 
      Physical Name(1): L:\Libraries\HUD\Data

=====================================================================
Current FmtSearch Option value:

     WORK* LIBRARY* GENERAL PRESCAT HUD

   *implicitly included by default.

=====================================================================
Status of current catalogs:

NOTE:    WORK.FORMATS DOES NOT EXIST
NOTE:    LIBRARY.FORMATS DOES NOT EXIST
NOTE:    GENERAL.FORMATS EXISTS
NOTE:    PRESCAT.FORMATS EXISTS
NOTE:    HUD.FORMATS EXISTS
=====================================================================


=====================================================================
Current Sasautos Option value:

     TTAUTOS PRESCA_R  HUD_R GENERA_L GENERA_R DCAUTOS UIAUTOS SASAUTOS

=====================================================================

91         
92         /*
93         %File_info( data=HUD.sec8mf_2014_10_dc, printobs=5 )
94         
95         title2 'HUD.sec8mf_2014_10_dc';
96         
97         data _null_;
98           set HUD.sec8mf_2014_10_dc;
99           where property_id = 800003675;
5 The SAS System                                                                               18:10 Monday, August 31, 2015

100          file print;
101          put / '--------------------';
102          put (_all_) (= /);
103        run;
104        */
105        
106        proc freq data=HUD.sec8mf_2014_10_dc;
107          tables program_type_group_code * program_type_name / list missing nocum nopercent;
108        run;

NOTE: There were 113 observations read from the data set HUD.SEC8MF_2014_10_DC.
NOTE: The PROCEDURE FREQ printed page 1.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.02 seconds
      cpu time            0.03 seconds
      

109        
110        title2;
111        
112        data DC_Info;
113        
114          set PresCat.DC_Info_07_08_15;
INFO: Data file PRESCAT.DC_INFO_07_08_15.DATA is in a format that is native to another host, or the file encoding does not 
match the session encoding. Cross Environment Data Access will be used, which might require additional CPU resources and 
might reduce performance.
115        
116          property_id = 1 * ID_MFA;
117        
118          ** Apply standard corrections **;
119        
120          %DCInfo_corrections()
MPRINT(DCINFO_CORRECTIONS):   ** Assign new NLIHC_ID to St. Dennis (duplicate ID with CEMI - Bethune House) **;
MPRINT(DCINFO_CORRECTIONS):   if NLIHC_ID = "NL001007" and upcase( Proj_Name ) = "ST. DENNIS" then NLIHC_ID = "NL001030";
MPRINT(DCINFO_CORRECTIONS):   if NLIHC_ID = "NL000046" then do;
MPRINT(DCINFO_CORRECTIONS):   units = 535;
MPRINT(DCINFO_CORRECTIONS):   Category = "1";
MPRINT(DCINFO_CORRECTIONS):   end;
121        
122          ** Tentative fixes for property_id - to be confirmed with Pres Network **;
123        
124          select ( NLIHC_ID );
125            when ( 'NL000137' )  /** 21 K TER NW **/
126              property_id = 800003730;
127            when ( 'NL000303' )  /** 222 W ST NW **/
128              property_id = 800003805;
6 The SAS System                                                                               18:10 Monday, August 31, 2015

129            when ( 'NL000098' )  /** 1312 EUCLID ST NW **/
130              property_id = 800003808;
131            when ( 'NL000999' )  /** 1350 Clifton St NW **/
132              property_id = 800003695;
133            when ( 'NL000234' )  /** 2701 ROBINSON PLACE SE **/
134              property_id = 800214527;
135            when ( 'NL000262' )  /** Sayles Place **/
136              property_id = 800003779;
137            otherwise
138              /** Do nothing **/;
139          end;
140        
141          if not missing( property_id );
142        
143        run;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      116:21   
NOTE: Missing values were generated as a result of performing an operation on missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      251 at 116:19   
NOTE: There were 361 observations read from the data set PRESCAT.DC_INFO_07_08_15.
NOTE: The data set WORK.DC_INFO has 116 observations and 103 variables.
NOTE: Compressing data set WORK.DC_INFO decreased size by 81.03 percent. 
      Compressed is 11 pages; un-compressed would require 58 pages.
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
      cpu time            0.01 seconds
      

144        
145        proc sort data=DC_Info;
146          by property_id;
147        

NOTE: There were 116 observations read from the data set WORK.DC_INFO.
NOTE: SAS sort was used.
NOTE: The data set WORK.DC_INFO has 116 observations and 103 variables.
NOTE: Compressing data set WORK.DC_INFO decreased size by 79.31 percent. 
      Compressed is 12 pages; un-compressed would require 58 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

148        proc sort data=HUD.sec8mf_2014_10_dc out=sec8mf_dc_a;
7 The SAS System                                                                               18:10 Monday, August 31, 2015

149          by property_id;
150        
151        ** Need data for two older projects no longer in current HUD database **;

NOTE: There were 113 observations read from the data set HUD.SEC8MF_2014_10_DC.
NOTE: SAS sort was used.
NOTE: The data set WORK.SEC8MF_DC_A has 113 observations and 103 variables.
NOTE: Compressing data set WORK.SEC8MF_DC_A decreased size by 50.00 percent. 
      Compressed is 7 pages; un-compressed would require 14 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

152        proc sort data=Hud.Sec8mf_2007_12_dc (where=(property_id in ( 800003695, 800003708 ))) out=sec8mf_dc_b;
153          by property_id;
154        

NOTE: There were 2 observations read from the data set HUD.SEC8MF_2007_12_DC.
      WHERE property_id in (800003695, 800003708);
NOTE: SAS sort was used.
NOTE: The data set WORK.SEC8MF_DC_B has 2 observations and 120 variables.
NOTE: Compressing data set WORK.SEC8MF_DC_B increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

155        data Sec8mf_dc;
156        
157          set sec8mf_dc_a sec8mf_dc_b (in=inb);
158          by property_id;
159        
160          if inb then tracs_status = 'T';
161        
162        run;

NOTE: Format $UIPRTYP was not found or could not be loaded.
WARNING: Multiple lengths were specified for the variable rent_to_fmr_description by input data set(s). This may cause 
         truncation of data.
NOTE: There were 113 observations read from the data set WORK.SEC8MF_DC_A.
NOTE: There were 2 observations read from the data set WORK.SEC8MF_DC_B.
NOTE: The data set WORK.SEC8MF_DC has 115 observations and 122 variables.
NOTE: Compressing data set WORK.SEC8MF_DC decreased size by 61.90 percent. 
      Compressed is 8 pages; un-compressed would require 21 pages.
8 The SAS System                                                                               18:10 Monday, August 31, 2015

NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

163        
164        %Dup_check(
165          data=Sec8mf_dc,
166          by=property_id contract_number,
167          id=
168        )
MPRINT(DUP_CHECK):   options nomprint;
NOTE: SAS threaded sort was used.
NOTE: Table WORK._DUP_CHECK created, with 0 rows and 3 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: [Dup_check] 0 duplicate observations found in data set SEC8MF_DC
NOTE: [Dup_check] for BY variables PROPERTY_ID CONTRACT_NUMBER.

NOTE: No observations in data set WORK._DUP_CHECK.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: Deleting WORK._DUP_CHECK (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

169        
170        proc format;
171          value $progfl
172            "Other S8 New" = "Sec 8 new construction"
173            "Other S8 Rehab" = "Sec 8 rehabilitation"
9 The SAS System                                                                               18:10 Monday, August 31, 2015

174            "PRAC 202/811" = "PRAC 202/811"
175            "S8 Loan Mgmt" = "Sec 8 loan management"
176            "S8 Prop. Disp." = "Sec 8 property disposition"
177            "S8 State Agency" = "Sec 8 state agency"
178            "Sec. 202" = "Sec 202";
NOTE: Format $PROGFL has been output.
179          value $oldcattoprog
180            'Sec. 202' = '202/8'
181            'S8 State Agency' = 'HFDA/8'
182            'S8 Loan Mgmt' = 'LMSA'
183            'S8 Prop. Disp.' = 'PD/8'
184            'PRAC 202/811' = 'PRAC/202/811'
185            'Other S8 New' = 'S8-NC'
186            'Other S8 Rehab' = 'S8-SR'
187            other = ' ';
NOTE: Format $OLDCATTOPROG has been output.
188        run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

189        
190        title2 'Dup_check: DC_Info';
191        
192        %Dup_check(
193          data=DC_Info,
194          by=property_id,
195          id=nlihc_id id_mfa
196        )
MPRINT(DUP_CHECK):   options nomprint;
NOTE: SAS threaded sort was used.
NOTE: Table WORK._DUP_CHECK created, with 0 rows and 4 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: [Dup_check] 0 duplicate observations found in data set DC_INFO
10 The SAS System                                                                              18:10 Monday, August 31, 2015

NOTE: [Dup_check] for BY variables PROPERTY_ID.

NOTE: No observations in data set WORK._DUP_CHECK.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: Deleting WORK._DUP_CHECK (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

197        
198        title2 'Dup_check: Sec8mf_dc';
199        
200        %Dup_check(
201          data=Sec8mf_dc,
202          by=property_id,
203          id=contract_number
204        )
MPRINT(DUP_CHECK):   options nomprint;
NOTE: SAS threaded sort was used.
NOTE: Compressing data set WORK._DUP_CHECK increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK._DUP_CHECK created, with 16 rows and 3 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: [Dup_check] 16 duplicate observations found in data set SEC8MF_DC
NOTE: [Dup_check] for BY variables PROPERTY_ID.

NOTE: There were 16 observations read from the data set WORK._DUP_CHECK.
NOTE: The PROCEDURE PRINT printed pages 2-3.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
11 The SAS System                                                                              18:10 Monday, August 31, 2015

      cpu time            0.00 seconds
      


NOTE: Deleting WORK._DUP_CHECK (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

205        
206        title2;
207        
208        data PresCat.Subsidy_mfa;
209        
210          length MFA_ASSUNITS 8;
211        
212          merge
213            DC_Info
214              (keep=NLIHC_ID Category ID_MFA MFA_SOURCE MFA_PROG MFA_START MFA_END MFA_ASSUNITS MFA_NOTES
215                    property_id Proj_name Proj_Addre
216               in=in1)
217            sec8mf_dc
218              (keep=contract_number property_id tracs_effective_date tracs_current_expiration_date
219                    tracs_overall_expiration_date tracs_status program_type_name assisted_units_count
220                    address_line1_text rent_to_FMR_description extract_date
221               where=(not(program_type_name = "UnasstPrj SCHAP" and assisted_units_count = 0))
222               in=in2);
223          by property_id;
224        
225          in_DC_Info = in1;
226          in_MFA = in2;
227        
228          ** Clean project names **;
229        
230          %Project_name_clean( Proj_name, Proj_name )
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = propcase( left( compbl( Proj_name ) ) );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Iii', 'III' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Ii', 'II' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Iv', 'IV' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'IVy', 'Ivy' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Ne', 'NE' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'NEw', 'New' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'NEighborhood', 'Neighborhood' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'NEighbors', 'Neighbors' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Nw', 'NW' );
12 The SAS System                                                                              18:10 Monday, August 31, 2015

MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Se', 'SE' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'SEnior', 'Senior' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'SEcond', 'Second' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'SErvices', 'Services' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'SEnate', 'Senate' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Sw', 'SW' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'At', 'at' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'atlantic', 'Atlantic' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Pud', 'PUD' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Chhi', 'CHHI' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Ncba', 'NCBA' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Cemi', 'CEMI' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Idi', 'IDI' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Wdc', 'WDC' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Mlk', 'MLK' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Ufas', 'UFAS' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Dmh', 'DMH' );
MPRINT(PROJECT_NAME_CLEAN):   Proj_name = tranwrd( Proj_name, 'Tcb', 'TCB' );
231        
232          ** Fix data problem **;
233        
234          if mfa_source  =: "HUD - Multifamily AssisHUD" then
235            mfa_source = substr( mfa_source, 24 );
236        
237          ** Create standardized variables **;
238        
239          length
240            Subsidy_Active 3
241            Subsidy_Info_Source_ID $ 40
242            Subsidy_Info_Source_Var $ 32
243            Subsidy_Info_Source $ /*16*/ 40
244            Subsidy_Info_Source_Date 8
245            Update_Dtm 8
246          ;
247        
248          if tracs_status in ( 'T' ) or not in_MFA then Subsidy_Active = 0;
249          else Subsidy_Active = 1;
250        
251          Subsidy_Info_Source = "HUD/MFA";
252        
253          Subsidy_Info_Source_ID = trim( left( put( property_id, 16. ) ) ) || "/" ||
254                                   left( contract_number );
255        
256          Subsidy_Info_Source_Var = "property_id/contract_number";
257        
258          if in_MFA then do;
13 The SAS System                                                                              18:10 Monday, August 31, 2015

259        
260            Subsidy_Info_Source_Date = extract_date;
261        
262          end;
263          else if mfa_source  =: "HUD - Multifamily Assistance and Section 8 Contracts" then do;
264        
265              Subsidy_Info_Source_Date =
266                input(
267                  substr( mfa_source,
268                          indexc( mfa_source, '(' ) + 1,
269                          indexc( mfa_source, ')' ) - ( indexc( mfa_source, '(' ) + 1 ) ),
270                  mmddyy8. );
271        
272          end;
273          else do;
274        
275            Subsidy_Info_Source_Date = .u;
276        
277          end;
278        
279          ** Program code **;
280        
281          length Program $ 32;
282        
283          Program = put( program_type_name, $mfatoprog. );
284        
285          if Program = "" then Program = put( mfa_prog, $oldcattoprog. );
286        
287          ** Update subsidy info **;
288        
289          ID_MFA = property_id;
290          if not missing( tracs_effective_date ) and missing( MFA_START ) then MFA_START = tracs_effective_date;
291          if not missing( tracs_overall_expiration_date ) and missing( MFA_END ) then MFA_END =
291      ! tracs_overall_expiration_date;
292          if missing( MFA_ASSUNITS ) and assisted_units_count > 0 then MFA_ASSUNITS = assisted_units_count;
293        
294          ** Eliminate entries not in MFA database and with no subsidy info in Catalog **;
295        
296          if not in_MFA and missing( mfa_assunits) and missing( mfa_source ) and missing( mfa_prog )
297          and missing( mfa_start ) and missing( mfa_end ) and missing( mfa_notes ) then delete;
298        
299          ** Compliance period end date (same as subsidy end date for MFA programs) **;
300        
301          Compl_end = mfa_end;
302        
303          ** Stamp with today's datetime **;
14 The SAS System                                                                              18:10 Monday, August 31, 2015

304        
305          Update_dtm = datetime();
306        
307          format
308            Subsidy_Active dyesno.
309            Subsidy_Info_Source $infosrc.
310            Subsidy_Info_Source_Date mmddyy10.
311            Update_Dtm datetime16.;
312        
313        run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      289:12   
NOTE: There were 116 observations read from the data set WORK.DC_INFO.
NOTE: There were 113 observations read from the data set WORK.SEC8MF_DC.
      WHERE (program_type_name not = 'UnasstPrj SCHAP') or (assisted_units_count not = 0);
NOTE: The data set PRESCAT.SUBSIDY_MFA has 121 observations and 32 variables.
NOTE: Compressing data set PRESCAT.SUBSIDY_MFA decreased size by 37.50 percent. 
      Compressed is 5 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

314        
315        proc sort data=PresCat.Subsidy_mfa;
316          by property_id contract_number;
317        run;

NOTE: There were 121 observations read from the data set PRESCAT.SUBSIDY_MFA.
NOTE: SAS sort was used.
NOTE: The data set PRESCAT.SUBSIDY_MFA has 121 observations and 32 variables.
NOTE: Compressing data set PRESCAT.SUBSIDY_MFA decreased size by 37.50 percent. 
      Compressed is 5 pages; un-compressed would require 8 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

318        
319        %File_info( data=PresCat.Subsidy_mfa, printobs=10,
320                    freqvars=tracs_status mfa_prog mfa_source
321                             Subsidy_Active Subsidy_Info_Source_Var Subsidy_Info_Source subsidy_info_source_date program
322                             rent_to_FMR_description )
MPRINT(FILE_INFO):   title2 "File = PresCat.Subsidy_mfa";
MPRINT(FILE_INFO):   proc contents data=PresCat.Subsidy_mfa;
15 The SAS System                                                                              18:10 Monday, August 31, 2015

MPRINT(FILE_INFO):   run;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
NOTE: The PROCEDURE CONTENTS printed pages 4-5.

MPRINT(FILE_INFO):   proc print data=PresCat.Subsidy_mfa (obs=10);
MPRINT(FILE_INFO):   title3 "Printing first 10 obs.";
MPRINT(FILE_INFO):   run;

WARNING: Data too long for column "MFA_NOTES"; truncated to 120 characters to fit.
NOTE: There were 10 observations read from the data set PRESCAT.SUBSIDY_MFA.
NOTE: The PROCEDURE PRINT printed pages 6-9.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(FILE_INFO):   title3;
MPRINT(FILE_INFO):   options nolabel;
MPRINT(FILE_INFO):   proc means data=PresCat.Subsidy_mfa n sum mean stddev min max;
MPRINT(FILE_INFO):   run;

NOTE: Multiple concurrent threads will be used to summarize data.
NOTE: There were 121 observations read from the data set PRESCAT.SUBSIDY_MFA.
NOTE: The PROCEDURE MEANS printed page 10.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(FILE_INFO):   options label;
MPRINT(FILE_INFO):   proc freq data=PresCat.Subsidy_mfa;
MPRINT(FILE_INFO):   tables tracs_status mfa_prog mfa_source Subsidy_Active Subsidy_Info_Source_Var Subsidy_Info_Source 
subsidy_info_source_date program rent_to_FMR_description / missing;
MPRINT(FILE_INFO):   run;

NOTE: There were 121 observations read from the data set PRESCAT.SUBSIDY_MFA.
NOTE: The PROCEDURE FREQ printed pages 11-14.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

16 The SAS System                                                                              18:10 Monday, August 31, 2015

MPRINT(FILE_INFO):   title2;
323        
324        proc freq data=PresCat.Subsidy_mfa;
325          tables in_DC_Info * in_MFA / list missing;
326          tables program_type_name * mfa_prog * program / list missing nocum nopercent;
327          format program_type_name mfa_prog program ;
328        run;

NOTE: There were 121 observations read from the data set PRESCAT.SUBSIDY_MFA.
NOTE: The PROCEDURE FREQ printed page 15.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

329        
330        proc print data=PresCat.Subsidy_mfa;
331          where program = "";
332          id Nlihc_id;
333          var in_mfa in_dc_info property_id Proj_Addre mfa_: ;
334          title2 'No program info';
335        run;

NOTE: No observations were selected from data set PRESCAT.SUBSIDY_MFA.
NOTE: There were 0 observations read from the data set PRESCAT.SUBSIDY_MFA.
      WHERE program=' ';
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

336        
337        proc print data=PresCat.Subsidy_mfa;
338          where in_MFA and not in_DC_Info;
339          id property_id;
340          var in_mfa in_dc_info NLIHC_ID address_line1_text contract_number program_type_name assisted_units_count
340      ! tracs_: ;
341          title2 'Not in DC_Info';
342        run;

NOTE: There were 1 observations read from the data set PRESCAT.SUBSIDY_MFA.
      WHERE in_MFA and (not in_DC_Info);
NOTE: The PROCEDURE PRINT printed page 16.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
17 The SAS System                                                                              18:10 Monday, August 31, 2015

      

343        
344        proc print data=PresCat.Subsidy_mfa;
345          where not in_MFA and in_DC_Info;
346          id property_id;
347          var in_mfa in_dc_info NLIHC_ID Proj_Addre mfa_: ;
348          title2 'Not in HUD MFA';
349        run;

NOTE: There were 8 observations read from the data set PRESCAT.SUBSIDY_MFA.
      WHERE (not in_MFA) and in_DC_Info;
NOTE: The PROCEDURE PRINT printed page 17.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

350        
351        title2 'PresCat.Subsidy_mfa: Duplicates for Subsidy_Info_Source_ID';
352        
353        %Dup_check(
354          data=PresCat.Subsidy_mfa,
355          by=Subsidy_Info_Source_ID,
356          id=NLIHC_ID property_id contract_number mfa_prog program_type_name assisted_units_count tracs_status,
357          out=_dup_check,
358          listdups=Y,
359          count=dup_check_count,
360          quiet=N,
361          debug=N
362        )
MPRINT(DUP_CHECK):   options nomprint;
NOTE: SAS threaded sort was used.
NOTE: Table WORK._DUP_CHECK created, with 0 rows and 9 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: [Dup_check] 0 duplicate observations found in data set PRESCAT.SUBSIDY_MFA
18 The SAS System                                                                              18:10 Monday, August 31, 2015

NOTE: [Dup_check] for BY variables SUBSIDY_INFO_SOURCE_ID.

NOTE: No observations in data set WORK._DUP_CHECK.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: Deleting WORK._DUP_CHECK (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

363        
364        run;
365        
366        title2;
367        
368        /*
369        proc freq data=PresCat.Subsidy_mfa;
370          where property_id not in ( 800003675, 800003741, 800003784, 800218816 );
371          tables mfa_prog * program_type_name / list missing;
372        run;
373        */
374        
375        ** Export all records for review **;
376        
377        ods listing close;
378        
379        ods tagsets.excelxp file="&_dcdata_r_path\PresCat\Data\Subsidy.xls" style=/*Minimal*/Normal
380            options( sheet_interval='Proc' orientation='landscape' );
NOTE: Writing TAGSETS.EXCELXP Body file: L:\Libraries\PresCat\Data\Subsidy.xls
NOTE: This is the Excel XP tagset (Compatible with SAS 9.1.3 and above, v1.94, 09/09/12). Add options(doc='help') to the 
ods statement for more information.
381        
382        proc print data=PresCat.Subsidy_mfa;
383          id property_id;
384          var NLIHC_ID proj_name in_: contract_number
385              Proj_Addre address_line1_text
386              mfa_prog program_type_name
387              MFA_ASSUNITS assisted_units_count
388              mfa_start tracs_effective_date
389              mfa_end tracs_current_expiration_date tracs_overall_expiration_date tracs_status
390              mfa_source mfa_notes
19 The SAS System                                                                              18:10 Monday, August 31, 2015

391              ;
392        run;

NOTE: There were 121 observations read from the data set PRESCAT.SUBSIDY_MFA.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.22 seconds
      cpu time            0.23 seconds
      

393        
394        ods tagsets.excelxp close;
395        ods listing;
396        
397        ** Print differences in MFA and Catalog info **;
398        
399        proc print data=PresCat.Subsidy_mfa;
400          where mfa_prog ~= put( program_type_name, $prgh2oc. );
401          id property_id;
402          by property_id;
403          var NLIHC_ID proj_name contract_number
404              mfa_prog program_type_name
405              ;
406          title2 'Program mismatch';
407        run;

NOTE: There were 15 observations read from the data set PRESCAT.SUBSIDY_MFA.
      WHERE mfa_prog not = PUT(program_type_name, $PRGH2OC15.);
NOTE: The PROCEDURE PRINT printed pages 18-21.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

408        
409        proc print data=PresCat.Subsidy_mfa;
410          where mfa_assunits ~= assisted_units_count;
411          id property_id;
412          by property_id;
413          var NLIHC_ID proj_name contract_number
414              MFA_ASSUNITS assisted_units_count
415              ;
416          title2 'Assisted units mismatch';
417        run;

NOTE: There were 21 observations read from the data set PRESCAT.SUBSIDY_MFA.
      WHERE mfa_assunits not = assisted_units_count;
20 The SAS System                                                                              18:10 Monday, August 31, 2015

NOTE: The PROCEDURE PRINT printed page 22.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

418        
419        title2;
420        
421        **** Compare with earlier version ****;
422        
423        libname comp 'D:\DCData\Libraries\PresCat\Data\Old';
NOTE: Libref COMP was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: D:\DCData\Libraries\PresCat\Data\Old
424        
425        proc compare base=Comp.Subsidy_mfa compare=PresCat.Subsidy_mfa maxprint=(40,32000);
426          id property_id contract_number;
427        run;

NOTE: There were 121 observations read from the data set COMP.SUBSIDY_MFA.
NOTE: There were 121 observations read from the data set PRESCAT.SUBSIDY_MFA.
NOTE: At least one W.D format was too small for the number to be printed. The decimal may be shifted by the "BEST" format.
NOTE: The PROCEDURE COMPARE printed pages 23-31.
NOTE: PROCEDURE COMPARE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           4.59 seconds
      cpu time            1.27 seconds
      
